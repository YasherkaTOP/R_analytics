# Учебный проект аналитики на языке R

### Описание задачи

Михаил, владелец недавно открывшегося банка TrustUs, хочет получить подробный аналитический отчёт о платёжеспособности и потребительском поведении жителей регионов России в 2020 году. Его интересует, в каких регионах России население более активно делает покупки, осуществляет безналичные платежи, берёт кредиты и ипотеку, а также пользуется услугами онлайн-банка. Отчёт поможет Михаилу решить, в каких регионах ему следует запланировать открытие большего числа филиалов банка, а также понять, от каких факторов зависит спрос на услуги банков.

Михаил также заинтересован в развитии и поддержке системы безналичных платежей. Он хочет сконцентрироваться на тех регионах, которые наиболее привлекательны для российских туристов, так как по сравнению с местными жителями туристы более склонны совершать безналичные платежи.

Михаил обратился к вам за помощью и попросил подготовить для него аналитический отчёт, который позволил бы ответить на интересующие его вопросы и решить, в каких регионах следует запланировать открытие большего числа филиалов банка и развивать системы безналичных платежей.

В дополнение к исследованию поведения потребителей Михаил хочет получить интерактивную аналитическую панель (дашборд), которая позволяла бы быстро визуализировать распределение интересующих его показателей и отслеживать их динамику в течение 2020 года.


## Часть 1
Создайте один большой файл Excel с одним листом, на котором будут представлены значения показателей из всех файлов с данными за 2020 год. Единица анализа (одно наблюдение) — регион в конкретный месяц в конкретный год. Агрегирование числовых показателей, представленных с детализацией с точностью до дня, производится усреднением с помощью медианного значения (считается медианное значение показателя по каждому месяцу).

Итоговый датафрейм должен выглядеть таким образом:

Регион Год Месяц Квартал Индекс.БП Индекс.ПА …

Республика Адыгея 2020 январь квартал 1 45.9 50.0
Республика Адыгея 2020 февраль квартал 1 41.7 56.0
…
Алтайский край 2020 январь квартал 1 54.1 64.0
Алтайский край 2020 февраль квартал 1 50.4 74.0
…


## Часть 2
#### Выбор регионов, лидирующих по потребительской активности, безналичным платежам и внутреннему туризму
1. Выведите описательные статистики для каждого показателя из группы СберИндекс. Прокомментируйте полученные результаты.
2. Для каждого показателя из группы СберИндекс постройте график, который показывал бы динамику среднего значения индекса по России в течение 2020 года. Приведите график в порядок, он пойдёт в ваш отчёт. Прокомментируйте полученные результаты.
3. Постройте ящики с усами для каждого показателя из группы СберИндекс (исходные данные, не средние по России) с группировкой по месяцу. У вас должен получиться график с 12 окнами-фасетками с тремя ящиками с усами в каждом. Приведите график в порядок, он пойдёт в ваш отчёт. Прокомментируйте полученные результаты.
4. Проверьте, есть ли среди значений показателей из группы СберИндекс нетипичные наблюдения. Если есть, укажите их для каждого месяца. Сохраните строки, соответствующие нетипичным наблюдениям, в отдельный датафрейм. Предложите свои объяснения, почему такие нетипичные значения могли возникнуть.
5. Определите, в каких регионах в среднем потребителей можно считать наиболее активными, а в каких — наименее активными. Выберите 30 наиболее активных регионов и сохраните их в отдельный датафрейм.
6. Определите, какие регионы, в среднем, лидируют по доле безналичных платежей. Выберите 30 регионов с наибольшей средней долей безналичных платежей.
7. Выберите те регионы, которые одновременно лидируют по потребительской активности и доле безналичных платежей. Другими словами, найдите регионы, общие для списков, полученных в пунктах 5 и 6. Перечислите эти регионы.
8. Выберите строки, соответствующие регионам из предыдущего пункта, и сохраните их в отдельный датафрейм.
9. Определите, в каких регионах среди отобранных на предыдущих шагах, индекс внутреннего туризма принимал значения выше 0 не менее чем в течение 5 месяцев (не обязательно подряд). Перечислите эти регионы.
10. Выберите строки, соответствующие регионам из предыдущего пункта, и сохраните их в отдельный датафрейм.
11. Используя результаты, полученные в предыдущих пунктах, сформулируйте рекомендации Михаилу: на какие регионы при планировании открытия филиалов банка ему нужно обратить внимание. Укажите:
месяцы, в которые потребители этих регионов наиболее активны;
месяцы, в которые потребители этих регионов чаще всего совершают безналичные платежи;
месяцы, в которые эти регионы чаще всего посещают внутренние туристы.

#### Поиск взаимосвязей
1. Постройте диаграмму рассеивания, которая визуализировала бы связь между показателями Индекс безналичных платежей и Индекс внутреннего туризма. Приведите график в порядок, он пойдёт в ваш отчёт.
2. Проверьте формально, можно ли считать показатели Индекс безналичных платежей и Индекс внутреннего туризма связанными. Если да, укажите направление и силу связи.
3. Используя результаты пунктов 1 и 2, прокомментируйте, можно ли считать предположение Михаила о том, что в регионах, которые более активно посещаются туристами, доля безналичных платежей выше.
4. Проверьте формально, можно ли считать, что в тех регионах, где жители чаще берут кредиты, число ипотечных сделок также выше. Для ответа на этот вопрос, возможно, понадобится поработать со шкалами указанных показателей.
5. Проверьте формально, можно ли считать, что в тех регионах, где доля безналичных платежей выше, жители чаще подают заявки на кредиты онлайн.
6. Обобщите выводы, полученные в пунктах 4 и 5, и включите их в отчёт для Михаила. В качестве подтверждения ваших выводов не забудьте включить в отчёт выдачи R, подтверждающие ваши мысли.
7. Добавьте в датафрейм столбец Сезон, который содержит следующие значения в зависимости от месяца наблюдения: зима, весна, лето, осень.
8. Постройте столбиковую диаграмму, которая бы иллюстрировала соотношение количества ипотечных сделок, заключённых в разное время года, для каждой категории числа ипотечных сделок (10–50, 50–100, 100–500, 500–1000, больше 1000). Приведите график в порядок, он пойдёт в ваш отчёт. Прокомментируйте полученный график и зафиксируйте, когда жители регионов России чаще всего заключают сделки по ипотеке.
9. Постройте ящики с усами, которые бы показывали распределение доли онлайн-заявок на кредиты в зависимости от времени года. Можно ли, глядя на графики, понять, в какое время года люди чаще оформляют кредиты посредством онлайн-заявок? Если да, укажите это время года и приведите необходимые пояснения. Предложите свои идеи, объясняющие различия в количестве онлайн-заявок в зависимости от сезона.
10. Проверьте формально, можно ли считать, что доля онлайн-заявок на кредиты зависит от времени года. Проинтерпретируйте полученные результаты. 
11. Постройте ящики с усами, которые бы показывали распределение доли ипотечных сделок на вторичное жильё в зависимости от времени года. Можно ли, глядя на графики, понять, в какое время года люди чаще заключают сделки на вторичное жильё? Если да, укажите это время года и приведите необходимые пояснения. Предложите свои идеи, объясняющие различия в количестве сделок по «вторичке» в зависимости от сезона.
12. Проверьте формально, можно ли считать, что доля ипотечных сделок на вторичное жильё зависит от времени года. Проинтерпретируйте полученные результаты.
13. Обобщите результаты, полученные в пунктах 8–12. Подумайте, для чего эти результаты могут пригодиться Михаилу, и включите свои идеи в отчёт. В качестве подтверждения выводов не забудьте включить в отчёт выдачи R, подтверждающие ваши мысли.


## Часть 3
1. Постройте регрессионные модели, которые позволят выяснить следующее:
каким образом потребительская активность зависит от средней заработной платы в регионе, числа активных абонентов беспроводного наземного фиксированного доступа к сети Интернет и уровня безработицы населения;
каким образом доля безналичных платежей в торговом обороте зависит от средней заработной платы в регионе, числа активных абонентов беспроводного наземного фиксированного доступа к сети Интернет и уровня безработицы населения.
2. Добавьте в датафрейм столбец, состоящий из 0 и 1, где 1 означает, что доля онлайн-заявок на кредит превышает долю заявок в офисе банка. Давайте считать, что этот столбец отвечает за склонность населения предпочитать онлайн-услуги банка.
3. Добавьте в датафрейм столбец, состоящий из 0 и 1, где 1 соответствует регионам с числом ипотечных сделок больше 500. Давайте считать, что этот столбец отвечает за склонность населения оформлять ипотеку.
4. Постройте регрессионную модель, которая позволит выяснить, каким образом склонность населения предпочитать онлайн-услуги банка зависит от средней заработной платы в регионе, числа активных абонентов беспроводного наземного фиксированного доступа к сети Интернет и уровня безработицы населения.
5. Постройте регрессионную модель, которая позволит выяснить, каким образом склонность населения оформлять ипотеку зависит от средней заработной платы в регионе, числа активных абонентов беспроводного наземного фиксированного доступа к сети Интернет и уровня безработицы населения.

## Часть 4
#### Создание дашборда с Shiny
Дашборд должен состоять из следующих элементов.

1. Панель с заголовком (Title panel) — включает краткий, но информативный заголовок дашборда. 
2. Боковая панель с меню (Sidebar panel) — включает четыре вида меню:
- Выпадающее меню (Dropdown menu) для выбора региона. Включает перечень всех регионов России в алфавитном порядке, а также опцию «Россия», которая выбрана по умолчанию.
- Выпадающее меню (Dropdown menu) для выбора визуализируемого показателя. Включает перечень всех показателей, используемых в проекте, в алфавитном порядке (их 10). По умолчанию выбран первый показатель в перечне.
- Радиокнопки (Radio buttons) для выбора типа графика. Переключатель между двумя опциями — режимами визуализации: распределение показателя и динамика показателя. По умолчанию выбрана динамика показателя.
- Строка с вводом текстового значения для указания цвета графика. Строка для ввода текста пользователем. В качестве примера заполнения (placeholder) указано значение #808080 — код серого цвета в шестнадцатеричном формате. Этот же цвет используется в качестве цвета графика по умолчанию.
3. Основная панель (Main panel)
Включает график, построенный в соответствии с запросами пользователя, заданными в меню. Визуализация работает следующим образом:
- Если пользователь с помощью радиокнопок выбрал распределение показателя, в окне с графиком отрисовывается ящик с усами (box plot) для этого показателя. Указанный пользователем в меню цвет становится цветом заливки ящика с усами.
- Если пользователь с помощью радиокнопок выбрал динамику показателя, в окне с графиком отрисовывается линейный график (line plot) для этого показателя, отражающий изменения значений в течение 12 месяцев. Указанный пользователем в меню цвет становится цветом линии графика.
- Если пользователь выбрал конкретный регион, график строится только по данным, относящимся к этому региону.
- Если пользователь выбрал все регионы (опция «Россия»), то ящик с усами строится по всем данным в общем датафрейме, линейный график — по средним значениям выбранного показателя за каждый месяц. Так, первая точка на таком линейном графике — среднее значение показателя в январе, рассчитанное по всем регионам, вторая точка — среднее значение показателя в феврале, рассчитанное по всем регионам, и так далее.
